<p>Bitstamp on <a href="https://www.bitstamp.net/article/bitcoin-withdraws-suspended/" target="_blank">Tuesday</a> became the second Bitcoin exchange to halt withdrawals in recent days after a denial-of-service attack exploiting a property of the Bitcoin protocol made it difficult to verify transactions and customer balances. But Bitcoin experts <a href="http://www.coindesk.com/massive-concerted-attack-launched-bitcoin-exchanges/" target="_blank">say</a> the issue, which also <a href="https://www.mtgox.com/press_release_20140210.html" target="_blank">shut down</a> withdrawals at mega-exchange <a href="http://www.mtgox.com/" target="_blank">Mt. Gox</a>, can be averted with a few tweaks to how exchanges and wallet services track transactions.</p>

<p>"No funds have been lost and no funds are at risk," Bitstamp <a href="https://www.bitstamp.net/article/bitcoin-withdraws-suspended/" target="_blank">emphasized</a> in a statement. "This is a denial-of-service attack made possible by some misunderstandings in Bitcoin wallet implementations. These misunderstandings have simple solutions that are being implemented as we speak, and we're confident everything will be back to normal shortly."</p>

<p>The attack relies on a property of the Bitcoin protocol known as <a href="https://en.bitcoin.it/wiki/Transaction_Malleability" target="_blank">transaction malleability</a> that makes it possible to make slight tweaks to records of Bitcoin being sent from user to user without making the transactions invalid or changing the amount of money sent. The changes do, however, alter the computed hash, or digital fingerprint, that's stored with the transaction record and used as a transaction ID.</p>

<p>"If you've got, say, one Bitcoin that you're spending in your transaction, you can write that as '1 Bitcoin,' you can write that as '01 Bitcoin,' or you can write that as '001 bitcoin,'" says Bitcoin expert Andreas Antonopoulos, who is the chief security officer of Bitcoin wallet company <a href="http://blockchain.info/" target="_blank">Blockchain.info</a>. "All three of those are valid transactions and will spend that one Bitcoin, [and] they all have different hashes."</p>

<p>Since Bitcoin transaction records propagate through a peer-to-peer network of Bitcoin users, that makes it possible for attackers to make these modifications to transaction records before propagating them through the network. At some point, either the original transaction or the modified one will make it into the shared transaction record called the blockchain. If the modified transaction makes it there first, the parties to the original transaction will look for the original hash in the blockchain but won't find it.</p>

<p>When an exchange or wallet service fails to find the hash, it might believe the transaction didn't go through and, if a confused or malicious customer complains, it might repeat the transaction, actually sending double the amount of Bitcoin intended. Once Mt. Gox revealed it was vulnerable to malleability-based attacks, other exchanges were slammed by attempts to trick them into issuing duplicate withdrawals, Antonopoulos says.</p>

<p>But Antonopoulos says Bitcoin users have known for some time about transaction malleability, which was first <a href="https://bitcointalk.org/index.php?topic=8392.msg122410#msg122410" target="_blank">reported</a> in 2011, and can ultimately defeat the attacks simply by not relying on the hash as a unique and static identifier until after it's entered into the verified blockchain.</p>

<p>"In a few days they're going to resume withdrawals and the network will be more resilient," Antonopoulos predicts of Bitstamp, adding that Blockchain and some other exchange and wallet services, as listed in our recent <a href="http://www.fastcolabs.com/3026304/the-casually-interested-persons-guide-to-investing-in-bitcoin" target="_self">Bitcoin investment guide</a>, haven't been affected.</p>

<p>Neither Bitstamp nor Mt. Gox immediately offered a timeline for when customers would be able to withdraw their Bitcoin. Bitstamp said in its statement it was working on a "software fix," and Mt. Gox <a href="https://www.mtgox.com/press_release_20140210.html" target="_blank">indicated</a> it was working with Bitcoin developers to standardize an additional, non-malleable hash.</p>